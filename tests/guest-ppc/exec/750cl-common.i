/*
 * libbinrec: a recompiling translator for machine code
 * Copyright (c) 2016 Andrew Church <achurch@achurch.org>
 *
 * This software may be copied and redistributed under certain conditions;
 * see the file "COPYING" in the source code distribution for details.
 * NO WARRANTY is provided with this software.
 */

/*
 * This file should be included in all tests that run the 750CL test
 * routine; it defines the data array for the routine itself and provides
 * appropriate handlers and setup code.  Call setup_750cl() to set up a
 * state block.
 */

#include "tests/ppc-lut.h"

/*************************************************************************/
/*************************** PowerPC test code ***************************/
/*************************************************************************/

/* These files are automatically generated with the contents of the test
 * code assembled under various configurations.  The test source
 * (ppc750cl.s) and the script used to generate this file
 * (gen-ppc750cl-bin.pl) live in the etc/ppc directory. */
#if defined(USE_750CL_NO_FPSCR_STATE)
    #include "tests/guest-ppc/exec/ppc750cl-nofpscr-bin.i"
#elif defined(USE_750CL_NO_RECIPROCAL_TABLES)
    #include "tests/guest-ppc/exec/ppc750cl-notables-bin.i"
#else
    #include "tests/guest-ppc/exec/ppc750cl-bin.i"
#endif

/* Constants for the test routine. */
#define PPC750CL_MEMORY_SIZE        0x2000000
#define PPC750CL_START_ADDRESS      0x1000000
#define PPC750CL_SCRATCH_ADDRESS    0x100000
#define PPC750CL_ERROR_LOG_ADDRESS  0x200000

/*************************************************************************/
/************************* Expected error lists **************************/
/*************************************************************************/

/*
 * Include the appropriate error sets in an array of FailureRecord, and
 * pass the array with its length to check_750cl_errors().
 */

typedef struct FailureRecord {
    uint32_t insn;
    uint32_t address;
    uint32_t data[6];
} FailureRecord;

/* Expected errors for all tests. */
#define EXPECTED_ERRORS_COMMON  \
    /* stwcx. to different address, not handled by the translator. */        \
    {0x7C60212D,0x0100A73C, {0xFFFFFFFF,0xFFFFFFFF, 0x00000000,0x00000000}}, \
    /* lfd/paired-single data hazard. */                                     \
    {0xC89F0008,0x0100B8B8, {0x3FF00000,0x00000000, 0x00000000,0x00000000}}, \
    /* lfd/ps_merge misbehavior. */                                          \
    {0x10652C20,0x0100B95C, {0x00000000,0x00000000, 0x00000000,0x00000000}}, \
    /* lfd/ps_rsqrte misbehavior. */                                         \
    {0x11A01834,0x01011B80, {0x00000000,0x00000000, 0x1F800041,0x00002000}}, \
    {0x11A02034,0x01011C18, {0x7FF00000,0x00000000, 0x3F7FF400,0x84005000}}
/* Same, for the addresses in the no-reciprocal-tables version of the test
 * code. */
#define EXPECTED_ERRORS_COMMON_NO_RECIPROCAL_TABLES  \
    {0x7C60212D,0x0100A06C, {0xFFFFFFFF,0xFFFFFFFF, 0x00000000,0x00000000}}, \
    {0xC89F0008,0x0100B1F8, {0x3FF00000,0x00000000, 0x00000000,0x00000000}}, \
    {0x10652C20,0x0100B29C, {0x00000000,0x00000000, 0x00000000,0x00000000}}, \
    {0x11A01834,0x010110A8, {0x00000000,0x00000000, 0x1F800041,0x00002000}}, \
    {0x11A02034,0x01011140, {0x7FF00000,0x00000000, 0x3F7FF400,0x84005000}}

/* Expected errors for the ASSUME_NO_SNAN optimization. */
#define EXPECTED_ERRORS_ASSUME_NO_SNAN  \
    /* lfs on an SNaN. */                                                    \
    {0xC1040000,0x01006498, {0x7FFC0000,0x00000000, 0xFFFFFFFF,0x00000000}}, \
    /* lfsx on an SNaN. */                                                   \
    {0x7D00242E,0x01006608, {0x7FFC0000,0x00000000, 0xFFFFFFFF,0x00000000}}, \
    /* fres on an SNaN. */                                                   \
    {0xEC605830,0x01009A00, {0xFFFC0000,0x00000000, 0x00011000,0x00000000}}, \
    {0xEC602830,0x01009A24, {0xFFFC0000,0x00000000, 0x00011000,0x00000000}}, \
    {0xEC805830,0x01009A74, {0xFFFC0000,0x00000000, 0x00011000,0x00000000}}, \
    {0xEC801030,0x01009A94, {0x3FDFFF00,0x00000000, 0x00004000,0x00000000}}, \
    {0xEC601831,0x01009B10, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    /* Spurious failure caused by a stale SNaN exception picked up by the    \
     * fmuls at the end of calc_fres. */                                     \
    {0xECA02030,0x01009C6C, {0x3EFFF800,0x3EFFF800, 0x00004000,0x40000000}}, \
    /* Paired-single operations on SNaNs (which were quieted when loaded     \
     * with lfs). */                                                         \
    {0x10673C60,0x0100AB70, {0xFFE00000,0xFFE00000, 0x80000000,0x80000000}}, \
    {0xE07E0014,0x0100B10C, {0x7FD00000,0xFFE00000, 0x00000000,0x00000000}}, \
    {0xE07E8018,0x0100B15C, {0xFFE00000,0x3F800000, 0x00000000,0x00000000}}, \
    {0x10603890,0x0100BBA4, {0xFFE00000,0xFFE00000, 0x80000000,0x20000000}}, \
    {0x10603850,0x0100BE20, {0x7FE00000,0x7FE00000, 0x80000000,0x20000000}}, \
    {0x10603A10,0x0100C1B0, {0x7FE00000,0x7FE00000, 0x80000000,0x20000000}}, \
    {0x10603910,0x0100C49C, {0xFFE00000,0xFFE00000, 0x80000000,0x20000000}}, \
    /* Stale SNaN exception picked up by ps_cmpu0. */                        \
    {0x10000000,0x0100C64C, {0x20000000,0x00000000, 0xA1002000,0x00000000}}, \
    {0x10810000,0x0100C690, {0x24000000,0x00000000, 0xA1004000,0x00000000}}, \
    {0x13880000,0x0100C6D4, {0x00000008,0x00000000, 0xA1008000,0x00000000}}, \
    {0x13860000,0x0100C710, {0x00000001,0x00000000, 0xA1001000,0x00000000}}, \
    /* ps_cmpu0 on SNaNs. */                                                 \
    {0x13870000,0x0100C790, {0x00000001,0x00000000, 0x00001000,0x00000000}}, \
    {0x13803800,0x0100C7D4, {0x00000001,0x00000000, 0x00001000,0x00000000}}, \
    {0x12803800,0x0100C818, {0x00000100,0x00000000, 0x00001000,0x00000000}}, \
    {0x12800000,0x0100C858, {0x00000200,0x00000000, 0x00002000,0x00000000}}, \
    /* ps_cmpo0 on SNaNs. */                                                 \
    {0x13870040,0x0100CB28, {0x00000001,0x00000000, 0xA0081000,0x00000000}}, \
    {0x13803840,0x0100CB6C, {0x00000001,0x00000000, 0xA0081000,0x00000000}}, \
    {0x12803840,0x0100CBB0, {0x00000100,0x00000000, 0x20081000,0x00000000}}, \
    {0x12800040,0x0100CBF0, {0x00000200,0x00000000, 0x20082000,0x00000000}}, \
    {0x13070040,0x0100CC38, {0x00000010,0x00000000, 0xE0081080,0x00000000}}, \
    {0x13003840,0x0100CC80, {0x00000010,0x00000000, 0xE0081080,0x00000000}}, \
    {0x12003840,0x0100CCC4, {0x00001000,0x00000000, 0x60081080,0x00000000}}, \
    {0x12000040,0x0100CD04, {0x00002000,0x00000000, 0x60082080,0x00000000}}, \
    /* ps_cmpu1 on SNaNs. */                                                 \
    {0x13870080,0x0100CFCC, {0x00000001,0x00000000, 0x00001000,0x00000000}}, \
    {0x13803880,0x0100D010, {0x00000001,0x00000000, 0x00001000,0x00000000}}, \
    {0x12803880,0x0100D054, {0x00000100,0x00000000, 0x00001000,0x00000000}}, \
    {0x12800080,0x0100D094, {0x00000200,0x00000000, 0x00002000,0x00000000}}, \
    /* ps_cmpo1 on SNaNs. */                                                 \
    {0x138700C0,0x0100D268, {0x00000001,0x00000000, 0xA0081000,0x00000000}}, \
    {0x138038C0,0x0100D2AC, {0x00000001,0x00000000, 0xA0081000,0x00000000}}, \
    {0x128038C0,0x0100D2F0, {0x00000100,0x00000000, 0x20081000,0x00000000}}, \
    {0x128000C0,0x0100D330, {0x00000200,0x00000000, 0x20082000,0x00000000}}, \
    {0x130700C0,0x0100D378, {0x00000010,0x00000000, 0xE0081080,0x00000000}}, \
    {0x130038C0,0x0100D3C0, {0x00000010,0x00000000, 0xE0081080,0x00000000}}, \
    {0x120038C0,0x0100D404, {0x00001000,0x00000000, 0x60081080,0x00000000}}, \
    {0x120000C0,0x0100D444, {0x00002000,0x00000000, 0x60082080,0x00000000}}, \
    /* ps_add on SNaNs. */                                                   \
    {0x1061582A,0x0100D5EC, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106B082A,0x0100D610, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x1061702A,0x0100D66C, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x1078082A,0x0100D68C, {0x41500000,0x40000000, 0x4A800002,0x00004000}}, \
    {0x1065202A,0x0100D6AC, {0xFFFC0000,0x00000000, 0x7F800000,0x92031000}}, \
    {0x1065682A,0x0100D6E0, {0xFFFC0000,0x00000000, 0x7F800000,0x92031000}}, \
    {0x106D282A,0x0100D71C, {0x7FF00000,0x00000000, 0xFFE00000,0x92025000}}, \
    {0x1061582B,0x0100D86C, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    {0x1061182B,0x0100D8BC, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    /* ps_sum0 on SNaNs. */                                                  \
    {0x10615814,0x0100D98C, {0xFFFC0000,0x00000000, 0x00000000,0x00011000}}, \
    {0x106B0854,0x0100D9B0, {0xFFFC0000,0x00000000, 0x3F800000,0x00011000}}, \
    {0x10615894,0x0100DA08, {0xFFFC0000,0x00000000, 0x40000000,0x00011000}}, \
    {0x1061C094,0x0100DA28, {0x41500000,0x40000000, 0x40000000,0x00004000}}, \
    {0x10642AD4,0x0100DA90, {0x40080000,0x00000000, 0xFFE00000,0x00004000}}, \
    {0x10615815,0x0100DB78, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    {0x10611895,0x0100DBC8, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    /* ps_sum1 on SNaNs. */                                                  \
    {0x10615816,0x0100DC98, {0x00000000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106B0856,0x0100DCBC, {0x3FF00000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x10615896,0x0100DD14, {0x40000000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x1061C096,0x0100DD34, {0x40000000,0x00000000, 0x4A800002,0x00004000}}, \
    {0x10642AD6,0x0100DD9C, {0xFFFC0000,0x00000000, 0x40400000,0x00004000}}, \
    /* ps_sum1 excess precision (exceptions improperly generated by format   \
     * conversion when copying from frC). */                                 \
    {0x10612916,0x0100DE08, {0x3FF55555,0x60000000, 0x00000000,0x82022000}}, \
    {0x106128D6,0x0100DE3C, {0x7FF00000,0x00000000, 0x00000000,0x92022000}}, \
    {0x10610916,0x0100DE74, {0x40000000,0x00000000, 0x40000000,0x82024000}}, \
    /* ps_sum1 (Rc=1) on SNaNs. */                                           \
    {0x10615817,0x0100DE8C, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    {0x10611897,0x0100DEDC, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    /* ps_sub on SNaNs. */                                                   \
    {0x10615828,0x0100DFB0, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106B0828,0x0100DFD4, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x10617028,0x0100E030, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106E0828,0x0100E054, {0x41500000,0x00000000, 0x4A800000,0x00004000}}, \
    {0x10652028,0x0100E078, {0xFFFC0000,0x00000000, 0xFF800000,0x92031000}}, \
    {0x10656828,0x0100E0B0, {0xFFFC0000,0x00000000, 0xFF800000,0x92031000}}, \
    {0x106D2828,0x0100E0F0, {0xFFF00000,0x00000000, 0xFFE00000,0x92029000}}, \
    {0x10615829,0x0100E24C, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    {0x10611829,0x0100E29C, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    /* ps_mul on SNaNs. */                                                   \
    {0x106102F2,0x0100E3E0, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106B0072,0x0100E404, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106103B2,0x0100E45C, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x107C00B2,0x0100E47C, {0x41500000,0x00000000, 0x4A800000,0x00004000}}, \
    {0x10650132,0x0100E49C, {0xFFFC0000,0x00000000, 0x7F800000,0x92031000}}, \
    {0x10650372,0x0100E4D0, {0xFFFC0000,0x00000000, 0x7F800000,0x92031000}}, \
    {0x106D0172,0x0100E50C, {0x7FF00000,0x00000000, 0xFFE00000,0x92025000}}, \
    {0x106102F3,0x0100EAEC, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    {0x106100F3,0x0100EB3C, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    /* ps_muls0 on SNaNs. */                                                 \
    {0x10650118,0x0100EBB0, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x10650358,0x0100EBDC, {0x7FF00000,0x00000000, 0xFFE00000,0x92025000}}, \
    {0x10650119,0x0100EC0C, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    {0x10650359,0x0100EC64, {0xFFFFFFFF,0x00000000, 0x09000000,0x00000000}}, \
    /* ps_muls1 on SNaNs. */                                                 \
    {0x1065011A,0x0100ECE0, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x1065035A,0x0100ED0C, {0x7FF00000,0x00000000, 0xFFE00000,0x92025000}}, \
    {0x1065011B,0x0100ED3C, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    {0x1065035B,0x0100ED94, {0xFFFFFFFF,0x00000000, 0x09000000,0x00000000}}, \
    /* ps_div on SNaNs. */                                                   \
    {0x10615824,0x0100EEA0, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106B0824,0x0100EEC4, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x10617024,0x0100EF78, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x10780824,0x0100EF98, {0x41500000,0x00000000, 0x4A800000,0x00004000}}, \
    {0x10652024,0x0100EFB8, {0xFFFC0000,0x00000000, 0x7F800000,0x92031000}}, \
    {0x10656824,0x0100EFEC, {0xFFFC0000,0x00000000, 0x7F800000,0x92031000}}, \
    {0x106D2824,0x0100F028, {0x7FF00000,0x00000000, 0xFFE00000,0x92025000}}, \
    {0x10615825,0x0100F1E4, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    {0x10611825,0x0100F234, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    /* ps_madd on SNaNs. */                                                  \
    {0x10605B7A,0x0100F3C8, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106112FA,0x0100F3F8, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106158BA,0x0100F410, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106B107A,0x0100F44C, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106113BA,0x0100F528, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x107C08BA,0x0100F548, {0x41500000,0x40000000, 0x4A800002,0x00004000}}, \
    {0x1065693A,0x0100F56C, {0xFFFC0000,0x00000000, 0x7F800000,0x92031000}}, \
    {0x1065237A,0x0100F5A4, {0xFFFC0000,0x00000000, 0x7F800000,0x92031000}}, \
    {0x106D217A,0x0100F5E4, {0x7FF00000,0x00000000, 0xFFE00000,0x92025000}}, \
    {0x106112FB,0x0100F970, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    {0x106110FB,0x0100F9C0, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    /* ps_madds0 on SNaNs. */                                                \
    {0x1065291C,0x0100FA34, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x10650B5C,0x0100FA60, {0x7FF00000,0x00000000, 0xFFE00000,0x92025000}}, \
    {0x1065291D,0x0100FA90, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    {0x10650B5D,0x0100FAE8, {0xFFFFFFFF,0x00000000, 0x09000000,0x00000000}}, \
    /* ps_madds1 on SNaNs. */                                                \
    {0x1065291E,0x0100FB64, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x10650B5E,0x0100FB90, {0x7FF00000,0x00000000, 0xFFE00000,0x92025000}}, \
    {0x1065291F,0x0100FBC0, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    {0x10650B5F,0x0100FC18, {0xFFFFFFFF,0x00000000, 0x09000000,0x00000000}}, \
    /* ps_msub on SNaNs. */                                                  \
    {0x10605B78,0x0100FDB0, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106112F8,0x0100FDE0, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106158B8,0x0100FDF8, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106B1078,0x0100FE30, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106113B8,0x0100FEB4, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x10610FB8,0x0100FED4, {0x41500000,0x00000000, 0x4A800000,0x00004000}}, \
    {0x10656938,0x0100FEF8, {0xFFFC0000,0x00000000, 0x7F800000,0x92031000}}, \
    {0x10652378,0x0100FF30, {0xFFFC0000,0x00000000, 0x7F800000,0x92031000}}, \
    {0x106D2178,0x0100FF70, {0x7FF00000,0x00000000, 0xFFE00000,0x92025000}}, \
    {0x106112F9,0x01010298, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    {0x106110F9,0x010102E8, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    /* ps_nmadd on SNaNs. */                                                 \
    {0x10605B7E,0x01010478, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106112FE,0x010104A8, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106158BE,0x010104C0, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106B107E,0x010104FC, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106113BE,0x01010584, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x107C08BE,0x010105A4, {0xC1500000,0x40000000, 0xCA800002,0x00008000}}, \
    {0x1065693E,0x010105C8, {0xFFFC0000,0x00000000, 0xFF800000,0x92031000}}, \
    {0x1065237E,0x01010600, {0xFFFC0000,0x00000000, 0xFF800000,0x92031000}}, \
    {0x106D217E,0x01010640, {0xFFF00000,0x00000000, 0xFFE00000,0x92029000}}, \
    {0x106112FF,0x010109B0, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    {0x106110FF,0x01010A00, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    /* ps_nmsub on SNaNs. */                                                 \
    {0x10605B7C,0x01010B8C, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106112FC,0x01010BBC, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106158BC,0x01010BD4, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106B107C,0x01010C0C, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x106112FC,0x01010C90, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x107E087C,0x01010CB0, {0xC1500000,0x00000000, 0xCA800000,0x00008000}}, \
    {0x1065693C,0x01010CD4, {0xFFFC0000,0x00000000, 0xFF800000,0x92031000}}, \
    {0x1065237C,0x01010D0C, {0xFFFC0000,0x00000000, 0xFF800000,0x92031000}}, \
    {0x106D217C,0x01010D4C, {0xFFF00000,0x00000000, 0xFFE00000,0x92029000}}, \
    {0x106112FD,0x01011078, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    {0x106110FD,0x010110C8, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    /* ps_res on SNaNs. */                                                   \
    {0x10605830,0x010112BC, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x10602830,0x010112E4, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x10607030,0x01011340, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x10607830,0x01011364, {0x3FDFFF00,0x00000000, 0x3EFFF800,0x00004000}}, \
    {0x11C01830,0x0101138C, {0xFFFC0000,0x00000000, 0x7F7FFFFF,0x90031000}}, \
    {0x11C02030,0x010113C4, {0xFFFC0000,0x00000000, 0x7F7FFFFF,0x90031000}}, \
    {0x11C02830,0x01011404, {0x47EFFFFF,0xE0000000, 0xFFE00000,0x90024000}}, \
    {0x10605831,0x01011464, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    {0x10601831,0x010114B4, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    /* ps_rsqrte on SNaNs. */                                                \
    {0x10605834,0x010119AC, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x10602834,0x010119D4, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x10607034,0x01011A58, {0xFFFC0000,0x00000000, 0xFFE00000,0x00011000}}, \
    {0x10607834,0x01011A7C, {0x3FFFFE80,0x00000000, 0x3FFFF400,0x00004000}}, \
    {0x11C01834,0x01011AA0, {0xFFFC0000,0x00000000, 0x3F34FD00,0x00011000}}, \
    {0x11C02034,0x01011AD8, {0xFFFC0000,0x00000000, 0x3F34FD00,0x00011000}}, \
    {0x11C02834,0x01011B0C, {0x3FE69FA0,0x00000000, 0xFFE00000,0x00004000}}, \
    {0x10605835,0x01011C9C, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    {0x10601835,0x01011CEC, {0xFFFFFFFF,0x00000000, 0x00000000,0x00000000}}, \
    /* ps_sel with Rc=1 after an SNaN operation. */                          \
    {0x1062006F,0x0101210C, {0x00000000,0xFFFFFFFF, 0xFFFFFFFF,0xFFFFFFFF}}

/* Expected errors for the ASSUME_NO_SNAN optimization without FAST_FTFS. */
#define EXPECTED_ERRORS_ASSUME_NO_SNAN_NO_FAST_STFS  \
    /* Exception raised during single-to-double conversion in alias store    \
     * after the preceding ps_add, detected at this instruction. */          \
    {0x1067382A,0x0100D57C, {0x7FF00000,0x00000000, 0x7F800000,0xB3025000}}

/* Expected errors for the ASSUME_NO_SNAN optimization with FAST_STFS. */
#define EXPECTED_ERRORS_ASSUME_NO_SNAN_FAST_STFS  \
    /* stfs on an SNaN. */                                                   \
    {0xD1040000,0x0100675C, {0x7FE00000,0x00000000, 0xFFFFFFFF,0x00000000}}, \
    /* stfsx on an SNaN. */                                                  \
    {0x7D00252E,0x0100689C, {0x7FE00000,0x00000000, 0xFFFFFFFF,0x00000000}}

/* Expected errors for the FAST_FMULS optimization. */
#define EXPECTED_ERRORS_FAST_FMULS  \
    /* frC rounding tests for fmuls. */                                      \
    {0xEC6D00F2,0x010076F4, {0x40000000,0x00000000, 0x82024000,0x00000000}}, \
    {0xEDA40372,0x010077F0, {0x3CD00000,0x00000000, 0x82024000,0x00000000}}, \
    {0xEC640372,0x0100781C, {0xBCD00000,0x00000000, 0x82028000,0x00000000}}, \
    {0xEDA100F2,0x0100783C, {0x3FF00000,0x00000000, 0x82024000,0x00000000}}, \
    {0xEC830132,0x01007878, {0x3E5FFFFF,0xE0000000, 0x82024000,0x00000000}}, \
    {0xEDA30132,0x0100791C, {0xBE5FFFFF,0xE0000000, 0x82028000,0x00000000}}, \
    /* frC rounding tests for fmadds. */                                     \
    {0xEC6D20FA,0x010082B4, {0x40000000,0x00000000, 0x00004000,0x00000000}}, \
    {0xEC81693A,0x01008368, {0x00000000,0x00000000, 0x00002000,0x00000000}}, \
    /* frC rounding tests for fmsubs. */                                     \
    {0xEC6D20F8,0x01008834, {0x40000000,0x00000000, 0x00004000,0x00000000}}, \
    {0xEC812138,0x010088D8, {0x00000000,0x00000000, 0x00002000,0x00000000}}, \
    /* frC rounding tests for fnmadds. */                                    \
    {0xEC6D20FE,0x01008DA8, {0xC0000000,0x00000000, 0x00008000,0x00000000}}, \
    {0xEC81693E,0x01008E68, {0x80000000,0x00000000, 0x00012000,0x00000000}}, \
    /* frC rounding tests for fnmsubs. */                                    \
    {0xEC6D20FC,0x01009330, {0xC0000000,0x00000000, 0x00008000,0x00000000}}, \
    {0xEC81213C,0x010093D8, {0x80000000,0x00000000, 0x00012000,0x00000000}}, \
    /* frC rounding tests for ps_mul. */                                     \
    {0x106D00F2,0x0100E68C, {0x40000000,0x00000000, 0x00000000,0x82024000}}, \
    {0x106403B2,0x0100E800, {0x3CD00000,0x00000000, 0x00000000,0x82024000}}, \
    {0x10640372,0x0100E854, {0xBCD00000,0x00000000, 0x00000000,0x82028000}}, \
    {0x106100F2,0x0100E884, {0x3FF00000,0x00000000, 0x00000000,0x82024000}}, \
    {0x106303B2,0x0100E8D8, {0x3E5FFFFF,0xE0000000, 0x00000000,0x82024000}}, \
    {0x106D03F2,0x0100E9AC, {0xBE5FFFFF,0xE0000000, 0x00000000,0x82028000}}, \
    /* frC rounding tests for ps_madd. */                                    \
    {0x106D20FA,0x0100F6B4, {0x40000000,0x00000000, 0x00000000,0x00004000}}, \
    {0x1061713A,0x0100F7FC, {0x00000000,0x00000000, 0x00000000,0x00002000}}, \
    /* frC rounding tests for ps_msub. */                                    \
    {0x106D20F8,0x01010030, {0x40000000,0x00000000, 0x00000000,0x00004000}}, \
    {0x10612138,0x01010140, {0x00000000,0x00000000, 0x00000000,0x00002000}}, \
    /* frC rounding tests for ps_nmadd. */                                   \
    {0x106D20FE,0x010106E8, {0xC0000000,0x00000000, 0x80000000,0x00008000}}, \
    {0x1061713E,0x01010840, {0x80000000,0x00000000, 0x80000000,0x00012000}}, \
    /* frC rounding tests for ps_nmsub. */                                   \
    {0x106D20FC,0x01010E0C, {0xC0000000,0x00000000, 0x80000000,0x00008000}}, \
    {0x1061213C,0x01010F24, {0x80000000,0x00000000, 0x80000000,0x00012000}}

/* Expected errors for the FAST_STFS optimization. */
#define EXPECTED_ERRORS_FAST_STFS  \
    {0xD0640020,0x01005020, {0x3FF55555,0x55555555, 0x3FAAAAAB,0x00000000}}, \
    {0xD0840020,0x0100506C, {0x380FFFFF,0xFFFFFFFF, 0x00800000,0x00000000}}, \
    {0xD0A40020,0x010050BC, {0x50123456,0x789ABCDE, 0x7F800000,0x00000000}}

/* Expected errors for the FNMADD_ZERO_SIGN optimization. */
#define EXPECTED_ERRORS_FNMADD_ZERO_SIGN  \
    /* fnmadd expecting a negative zero. */                                  \
    {0xFC64007E,0x01008A18, {0x00000000,0x00000000, 0x00002000,0x00000000}}, \
    {0xFC60013E,0x01008A2C, {0x00000000,0x00000000, 0x00002000,0x00000000}}, \
    {0xFC60207E,0x01008A40, {0x00000000,0x00000000, 0x00002000,0x00000000}}, \
    /* fnmadds with double-precision input expecting a negative zero. */     \
    {0xEC84687E,0x01008E4C, {0x00000000,0x00000000, 0x00002000,0x00000000}}, \
    /* fnmsubs with double-precision input expecting a negative zero. */     \
    {0xEC84207C,0x010093C0, {0x00000000,0x00000000, 0x00002000,0x00000000}}, \
    /* ps_nmadd expecting a negative zero. */                                \
    {0x1064007E,0x01010360, {0x00000000,0x00000000, 0x00000000,0x00002000}}, \
    {0x1060013E,0x01010378, {0x00000000,0x00000000, 0x00000000,0x00002000}}, \
    {0x1060207E,0x01010390, {0x00000000,0x00000000, 0x00000000,0x00002000}}, \
    /* ps_nmadd with double-precision input expecting a negative zero. */    \
    {0x1064707E,0x01010804, {0x00000000,0x00000000, 0x80000000,0x00002000}}, \
    /* ps_nmsub with double-precision input expecting a negative zero. */    \
    {0x1064207C,0x01010F00, {0x00000000,0x00000000, 0x00000000,0x00002000}}

/* Expected errors for the IGNORE_FPSCR_VXFOO optimization. */
#define EXPECTED_ERRORS_IGNORE_FPSCR_VXFOO  \
    /* fcmpo expecting VXVC. */                                              \
    {0xFF850040,0x010060D0, {0x00000001,0x00000000, 0xA1001000,0x00000000}}, \
    {0xFF802840,0x01006114, {0x00000001,0x00000000, 0xA1001000,0x00000000}}, \
    /* fcmpo expecting VXSNAN+VXVC. */                                       \
    {0xFF860040,0x01006158, {0x00000001,0x00000000, 0xA1001000,0x00000000}}, \
    {0xFF803040,0x0100619C, {0x00000001,0x00000000, 0xA1001000,0x00000000}}, \
    {0xFE803040,0x010061E0, {0x00000100,0x00000000, 0x21001000,0x00000000}}, \
    {0xFE800040,0x01006220, {0x00000200,0x00000000, 0x21002000,0x00000000}}, \
    /* fadd expecting VXISI. */                                              \
    {0xFC69682A,0x01006E74, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC6D482A,0x01006EF8, {0x41500000,0x00000000, 0xE1000000,0x00000000}}, \
    /* fsub expecting VXISI. */                                              \
    {0xFC694828,0x010070FC, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC6D6828,0x01007194, {0x41500000,0x00000000, 0xE1000000,0x00000000}}, \
    /* fmul expecting VXIMZ. */                                              \
    {0xFC690032,0x01007404, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC600372,0x0100741C, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC600272,0x0100749C, {0x41500000,0x00000000, 0xE1000000,0x00000000}}, \
    /* fdiv expecting VXIDI or VXZDZ. */                                     \
    {0xFC694824,0x01007A58, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC600024,0x01007A98, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC696824,0x01007B1C, {0x41500000,0x00000000, 0xE1000000,0x00000000}}, \
    {0xFC642024,0x01007B48, {0x41500000,0x00000000, 0xE1000000,0x00000000}}, \
    /* fmadd expecting VXIMZ, VXIMZ+VXSNAN, or VXISI. */                     \
    {0xFC6D48BA,0x01007EFC, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC69083A,0x01007F28, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC69203A,0x01007F40, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC69207A,0x01007F58, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC60227A,0x01007F70, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC61227A,0x01007F88, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC605B7A,0x01007FA0, {0xFFFC0000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC600A7A,0x0100808C, {0x41500000,0x00000000, 0xE1000000,0x00000000}}, \
    {0xFC6968BA,0x010080B8, {0x41500000,0x00000000, 0xE1000000,0x00000000}}, \
    /* fmsub expecting VXIMZ, VXIMZ+VXSNAN, or VXISI. */                     \
    {0xFC6D68B8,0x01008544, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC690838,0x01008574, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC694838,0x01008588, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC605B78,0x010085A0, {0xFFFC0000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC600A78,0x01008688, {0x41500000,0x00000000, 0xE1000000,0x00000000}}, \
    {0xFC6948B8,0x010086B0, {0x41500000,0x00000000, 0xE1000000,0x00000000}}, \
    /* fnmadd expecting VXIMZ, VXIMZ+VXSNAN, or VXISI. */                    \
    {0xFC6D48BE,0x01008AAC, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC69083E,0x01008AD8, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC69203E,0x01008AF0, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC605B7E,0x01008B08, {0xFFFC0000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC600A7E,0x01008BF4, {0x41500000,0x00000000, 0xE1000000,0x00000000}}, \
    {0xFC6968BE,0x01008C20, {0x41500000,0x00000000, 0xE1000000,0x00000000}}, \
    /* fnmsub expecting VXIMZ, VXIMZ+VXSNAN, or VXISI. */                    \
    {0xFC6D68BC,0x0100903C, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC69083C,0x0100906C, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC69483C,0x01009080, {0xFFF80000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC605B7C,0x01009098, {0xFFFC0000,0x00000000, 0xA1011000,0x00000000}}, \
    {0xFC600A7C,0x01009180, {0x41500000,0x00000000, 0xE1000000,0x00000000}}, \
    {0xFC6948BC,0x010091A8, {0x41500000,0x00000000, 0xE1000000,0x00000000}}, \
    /* fctiw expecting VXCVI without VXSNAN. */                              \
    {0xFC60D01C,0x0100959C, {0x7FFFFFFF,0x00000000, 0xA1000100,0x00000000}}, \
    {0xFC60D81C,0x010095B0, {0x80000000,0x00000000, 0xA1000100,0x00000000}}, \
    {0xFC60E01C,0x010095C4, {0x7FFFFFFF,0x00000000, 0xA1000100,0x00000000}}, \
    {0xFC60E81C,0x010095EC, {0x80000000,0x00000000, 0xA1000100,0x00000000}}, \
    {0xFC60501C,0x01009600, {0x80000000,0x00000000, 0xA1000100,0x00000000}}, \
    {0xFC80D01C,0x010096A8, {0x3FF00000,0x00000000, 0xE1000100,0x00000000}}, \
    {0xFC80E01C,0x010096BC, {0x3FF00000,0x00000000, 0xE1000100,0x00000000}}, \
    {0xFC80501C,0x010096D0, {0x3FF00000,0x00000000, 0xE1000100,0x00000000}}, \
    /* ps_cmpo0 expecting VXVC. */                                           \
    {0x13860040,0x0100CAA0, {0x00000001,0x00000000, 0xA1001000,0x00000000}}, \
    {0x13803040,0x0100CAE4, {0x00000001,0x00000000, 0xA1001000,0x00000000}}, \
    /* ps_cmpo0 expecting VXSNAN+VXVC. */                                    \
    {0x13870040,0x0100CB28, {0x00000001,0x00000000, 0xA1001000,0x00000000}}, \
    {0x13803840,0x0100CB6C, {0x00000001,0x00000000, 0xA1001000,0x00000000}}, \
    {0x12803840,0x0100CBB0, {0x00000100,0x00000000, 0x21001000,0x00000000}}, \
    {0x12800040,0x0100CBF0, {0x00000200,0x00000000, 0x21002000,0x00000000}}, \
    /* ps_cmpo1 expecting VXVC. */                                           \
    {0x138600C0,0x0100D1E0, {0x00000001,0x00000000, 0xA1001000,0x00000000}}, \
    {0x138030C0,0x0100D224, {0x00000001,0x00000000, 0xA1001000,0x00000000}}, \
    /* ps_cmpo1 expecting VXSNAN+VXVC. */                                    \
    {0x138700C0,0x0100D268, {0x00000001,0x00000000, 0xA1001000,0x00000000}}, \
    {0x138038C0,0x0100D2AC, {0x00000001,0x00000000, 0xA1001000,0x00000000}}, \
    {0x128038C0,0x0100D2F0, {0x00000100,0x00000000, 0x21001000,0x00000000}}, \
    {0x128000C0,0x0100D330, {0x00000200,0x00000000, 0x21002000,0x00000000}}, \
    /* ps_add expecting VXISI. */                                            \
    {0x1069682A,0x0100D5C0, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x106D482A,0x0100D640, {0x41500000,0x00000000, 0x4A800000,0xE1000000}}, \
    /* ps_sum0 expecting VXISI. */                                           \
    {0x10696814,0x0100D960, {0xFFF80000,0x00000000, 0x00000000,0xA1011000}}, \
    {0x106D4814,0x0100D9E0, {0x41500000,0x00000000, 0x4A800000,0xE1000000}}, \
    {0x106D2914,0x0100DA70, {0xFFF80000,0x00000000, 0x3F800000,0xA1011000}}, \
    /* ps_sum1 expecting VXISI. */                                           \
    {0x10696816,0x0100DC6C, {0x00000000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x106D4816,0x0100DCEC, {0x41500000,0x00000000, 0x4A800000,0xE1000000}}, \
    {0x106D2916,0x0100DD7C, {0x3FF00000,0x00000000, 0xFFC00000,0xA1011000}}, \
    /* ps_sub expecting VXISI. */                                            \
    {0x10694828,0x0100DF6C, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x106D6828,0x0100E004, {0x41500000,0x00000000, 0x4A800000,0xE1000000}}, \
    /* ps_mul expecting VXIMZ. */                                            \
    {0x10690032,0x0100E398, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x10600372,0x0100E3B4, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x10600272,0x0100E430, {0x41500000,0x00000000, 0x4A800000,0xE1000000}}, \
    /* ps_div expecting VXIDI, VXZDZ, or both. */                            \
    {0x10694824,0x0100EE28, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x10600024,0x0100EE74, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x10696824,0x0100EEF4, {0x41500000,0x00000000, 0x4A800000,0xE1000000}}, \
    {0x10642024,0x0100EF24, {0x41500000,0x00000000, 0x4A800000,0xE1000000}}, \
    {0x10631824,0x0100F054, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x10652824,0x0100F080, {0x3FF00000,0x00000000, 0x3F800000,0xE1000000}}, \
    /* ps_madd expecting some combination of VXIMZ (possibly with VXSNAN)    \
     * and VXISI. */                                                         \
    {0x106D48BA,0x0100F360, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x1069083A,0x0100F390, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x1069203A,0x0100F3AC, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x10605B7A,0x0100F3C8, {0xFFFC0000,0x00000000, 0xFFE00000,0xA1011000}}, \
    {0x10600A7A,0x0100F478, {0x41500000,0x00000000, 0x4A800000,0xE1000000}}, \
    {0x106968BA,0x0100F4A8, {0x41500000,0x00000000, 0x4A800000,0xE1000000}}, \
    {0x106D48FA,0x0100F618, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    /* ps_msub expecting VXIMZ[+VXSNAN] and/or VXISI. */                     \
    {0x106D68B8,0x0100FD48, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x10690838,0x0100FD7C, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x10694838,0x0100FD94, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x10605B78,0x0100FDB0, {0xFFFC0000,0x00000000, 0xFFE00000,0xA1011000}}, \
    {0x10600A78,0x0100FE5C, {0x41500000,0x00000000, 0x4A800000,0xE1000000}}, \
    {0x106948B8,0x0100FE88, {0x41500000,0x00000000, 0x4A800000,0xE1000000}}, \
    /* ps_nmadd expecting VXIMZ[+VXSNAN] and/or VXISI. */                    \
    {0x106D48BE,0x01010410, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x1069083E,0x01010440, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x1069203E,0x0101045C, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x10605B7E,0x01010478, {0xFFFC0000,0x00000000, 0xFFE00000,0xA1011000}}, \
    {0x10600A7E,0x01010528, {0x41500000,0x00000000, 0x4A800000,0xE1000000}}, \
    {0x106968BE,0x01010558, {0x41500000,0x00000000, 0x4A800000,0xE1000000}}, \
    /* ps_nmsub expecting VXIMZ[+VXSNAN] and/or VXISI. */                    \
    {0x106D68BC,0x01010B24, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x1069083C,0x01010B58, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x1069483C,0x01010B70, {0xFFF80000,0x00000000, 0xFFC00000,0xA1011000}}, \
    {0x10605B7C,0x01010B8C, {0xFFFC0000,0x00000000, 0xFFE00000,0xA1011000}}, \
    {0x10600A7C,0x01010C38, {0x41500000,0x00000000, 0x4A800000,0xE1000000}}, \
    {0x106948BC,0x01010C64, {0x41500000,0x00000000, 0x4A800000,0xE1000000}}

/* Expected errors for the NATIVE_IEEE_NAN optimization. */
#define EXPECTED_ERRORS_NATIVE_IEEE_NAN  \
    /* fadd returns default QNaN from subtraction of infinities. */          \
    {0xFC69682A,0x01006E74, {0xFFF80000,0x00000000, 0xA0811000,0x00000000}}, \
    /* fsub returns default QNaN from subtraction of infinities. */          \
    {0xFC694828,0x010070FC, {0xFFF80000,0x00000000, 0xA0811000,0x00000000}}, \
    /* fmul returns default QNaN from infinity * 0. */                       \
    {0xFC690032,0x01007404, {0xFFF80000,0x00000000, 0xA0111000,0x00000000}}, \
    {0xFC600372,0x0100741C, {0xFFF80000,0x00000000, 0xA0111000,0x00000000}}, \
    /* fdiv returns default QNaN from infinity / infinity. */                \
    {0xFC694824,0x01007A58, {0xFFF80000,0x00000000, 0xA0411000,0x00000000}}, \
    /* fdiv returns default QNaN from 0 / 0. */                              \
    {0xFC600024,0x01007A98, {0xFFF80000,0x00000000, 0xA0211000,0x00000000}}, \
    /* fmadd returns default QNaN from inf - inf or inf * 0. */              \
    {0xFC6D48BA,0x01007EFC, {0xFFF80000,0x00000000, 0xA0811000,0x00000000}}, \
    {0xFC69083A,0x01007F28, {0xFFF80000,0x00000000, 0xA0111000,0x00000000}}, \
    {0xFC69203A,0x01007F40, {0xFFF80000,0x00000000, 0xA0111000,0x00000000}}, \
    {0xFC69207A,0x01007F58, {0xFFF80000,0x00000000, 0xA0811000,0x00000000}}, \
    {0xFC60227A,0x01007F70, {0xFFF80000,0x00000000, 0xA0111000,0x00000000}}, \
    {0xFC61227A,0x01007F88, {0xFFF80000,0x00000000, 0xA0811000,0x00000000}}, \
    /* fmsub returns default QNaN from inf - inf or inf * 0. */              \
    {0xFC6D68B8,0x01008544, {0xFFF80000,0x00000000, 0xA0811000,0x00000000}}, \
    {0xFC690838,0x01008574, {0xFFF80000,0x00000000, 0xA0111000,0x00000000}}, \
    {0xFC694838,0x01008588, {0xFFF80000,0x00000000, 0xA0111000,0x00000000}}, \
    /* fnmadd returns default QNaN from inf - inf or inf * 0. */             \
    {0xFC6D48BE,0x01008AAC, {0xFFF80000,0x00000000, 0xA0811000,0x00000000}}, \
    {0xFC69083E,0x01008AD8, {0xFFF80000,0x00000000, 0xA0111000,0x00000000}}, \
    {0xFC69203E,0x01008AF0, {0xFFF80000,0x00000000, 0xA0111000,0x00000000}}, \
    /* fnmsub returns default QNaN from inf - inf or inf * 0. */             \
    {0xFC6D68BC,0x0100903C, {0xFFF80000,0x00000000, 0xA0811000,0x00000000}}, \
    {0xFC69083C,0x0100906C, {0xFFF80000,0x00000000, 0xA0111000,0x00000000}}, \
    {0xFC69483C,0x01009080, {0xFFF80000,0x00000000, 0xA0111000,0x00000000}}, \
    /* ps_add returns default QNaN from subtraction of infinities. */        \
    {0x1069682A,0x0100D5C0, {0xFFF80000,0x00000000, 0xFFC00000,0xA0811000}}, \
    /* ps_sum0 returns default QNaN from subtraction of infinities. */       \
    {0x10696814,0x0100D960, {0xFFF80000,0x00000000, 0x00000000,0xA0811000}}, \
    {0x106D2914,0x0100DA70, {0xFFF80000,0x00000000, 0x3F800000,0xA0811000}}, \
    /* ps_sum1 returns default QNaN from subtraction of infinities. */       \
    {0x10696816,0x0100DC6C, {0x00000000,0x00000000, 0xFFC00000,0xA0811000}}, \
    {0x106D2916,0x0100DD7C, {0x3FF00000,0x00000000, 0xFFC00000,0xA0811000}}, \
    /* ps_sub returns default QNaN from subtraction of infinities. */        \
    {0x10694828,0x0100DF6C, {0xFFF80000,0x00000000, 0xFFC00000,0xA0811000}}, \
    /* ps_mul returns default QNaN from infinity * 0. */                     \
    {0x10690032,0x0100E398, {0xFFF80000,0x00000000, 0xFFC00000,0xA0111000}}, \
    {0x10600372,0x0100E3B4, {0xFFF80000,0x00000000, 0xFFC00000,0xA0111000}}, \
    /* ps_div returns default QNaN from infinity / infinity or 0 / 0. */     \
    {0x10694824,0x0100EE28, {0xFFF80000,0x00000000, 0xFFC00000,0xA0411000}}, \
    {0x10600024,0x0100EE74, {0xFFF80000,0x00000000, 0xFFC00000,0xA0211000}}, \
    {0x10631824,0x0100F054, {0xFFF80000,0x00000000, 0xFFC00000,0xA0611000}}, \
    /* ps_madd returns default QNaN from inf - inf or inf * 0. */            \
    {0x106D48BA,0x0100F360, {0xFFF80000,0x00000000, 0xFFC00000,0xA0811000}}, \
    {0x1069083A,0x0100F390, {0xFFF80000,0x00000000, 0xFFC00000,0xA0111000}}, \
    {0x1069203A,0x0100F3AC, {0xFFF80000,0x00000000, 0xFFC00000,0xA0111000}}, \
    {0x106D48FA,0x0100F618, {0xFFF80000,0x00000000, 0xFFC00000,0xA0911000}}, \
    /* ps_msub returns default QNaN from inf - inf or inf * 0. */            \
    {0x106D68B8,0x0100FD48, {0xFFF80000,0x00000000, 0xFFC00000,0xA0811000}}, \
    {0x10690838,0x0100FD7C, {0xFFF80000,0x00000000, 0xFFC00000,0xA0111000}}, \
    {0x10694838,0x0100FD94, {0xFFF80000,0x00000000, 0xFFC00000,0xA0111000}}, \
    /* ps_nmadd returns default QNaN from inf - inf or inf * 0. */           \
    {0x106D48BE,0x01010410, {0xFFF80000,0x00000000, 0xFFC00000,0xA0811000}}, \
    {0x1069083E,0x01010440, {0xFFF80000,0x00000000, 0xFFC00000,0xA0111000}}, \
    {0x1069203E,0x0101045C, {0xFFF80000,0x00000000, 0xFFC00000,0xA0111000}}, \
    /* ps_nmsub returns default QNaN from inf - inf or inf * 0. */           \
    {0x106D68BC,0x01010B24, {0xFFF80000,0x00000000, 0xFFC00000,0xA0811000}}, \
    {0x1069083C,0x01010B58, {0xFFF80000,0x00000000, 0xFFC00000,0xA0111000}}, \
    {0x1069483C,0x01010B70, {0xFFF80000,0x00000000, 0xFFC00000,0xA0111000}}

/* Expected errors for the NATIVE_IEEE_NAN optimization without
 * NO_FPSCR_STATE. */
#define EXPECTED_ERRORS_NATIVE_IEEE_NAN_NO_NO_FPSCR_STATE  \
    /* fmadd chooses frB NaN (addend) over frC NaN (multiplier). */          \
    {0xFC6052FA,0x0100802C, {0xFFFC0000,0x00000000, 0xA1011000,0x00000000}}, \
    /* fmsub chooses frB NaN (addend) over frC NaN (multiplier). */          \
    {0xFC6052F8,0x01008628, {0xFFFC0000,0x00000000, 0xA1011000,0x00000000}}, \
    /* fnmadd chooses frB NaN (addend) over frC NaN (multiplier). */         \
    {0xFC6052FE,0x01008B94, {0xFFFC0000,0x00000000, 0xA1011000,0x00000000}}, \
    /* fnmsub chooses frB NaN (addend) over frC NaN (multiplier). */         \
    {0xFC6052FC,0x01009120, {0xFFFC0000,0x00000000, 0xA1011000,0x00000000}}

/* Expected errors for the NATIVE_IEEE_UNDERFLOW optimization. */
#define EXPECTED_ERRORS_NATIVE_IEEE_UNDERFLOW  \
    /* fadds result is tiny before rounding. */                              \
    {0xEC63682A,0x01007D80, {0x38100000,0x00000000, 0x82024000,0x00000000}}, \
    /* fsubs result is tiny before rounding. */                              \
    {0xEC636828,0x01007D9C, {0x38100000,0x00000000, 0x82024000,0x00000000}}, \
    /* fmadd result is tiny before rounding. */                              \
    {0xFC6320FA,0x01007EA4, {0x80100000,0x00000000, 0x82028000,0x00000000}}, \
    /* fmadds result is tiny before rounding. */                             \
    {0xEC6320FA,0x01008268, {0xB8100000,0x00000000, 0x82028000,0x00000000}}, \
    {0xEC64193A,0x010083F8, {0xB8100000,0x00000000, 0x82028000,0x00000000}}, \
    /* fmsub result is tiny before rounding. */                              \
    {0xFC6318F8,0x010084EC, {0x80100000,0x00000000, 0x82028000,0x00000000}}, \
    /* fmsubs result is tiny before rounding. */                             \
    {0xEC6318F8,0x010087E0, {0xB8100000,0x00000000, 0x82028000,0x00000000}}, \
    {0xEC641938,0x01008960, {0xB8100000,0x00000000, 0x82028000,0x00000000}}, \
    /* fnmadd result is tiny before rounding. */                             \
    {0xFC6320FE,0x01008A58, {0x00100000,0x00000000, 0x82024000,0x00000000}}, \
    /* fnmadds result is tiny before rounding. */                            \
    {0xEC6320FE,0x01008D60, {0x38100000,0x00000000, 0x82024000,0x00000000}}, \
    {0xEC64193E,0x01008EF8, {0x38100000,0x00000000, 0x82024000,0x00000000}}, \
    /* fnmsub result is tiny before rounding. */                             \
    {0xFC6318FC,0x01008FE8, {0x00100000,0x00000000, 0x82024000,0x00000000}}, \
    /* fnmsubs result is tiny before rounding. */                            \
    {0xEC6318FC,0x010092E0, {0x38100000,0x00000000, 0x82024000,0x00000000}}, \
    {0xEC64193C,0x01009460, {0x38100000,0x00000000, 0x82024000,0x00000000}}, \
    /* ps_madd result is tiny before rounding. */                            \
    {0x106320FA,0x0100F2F8, {0xB8100000,0x00000000, 0x80800000,0x82028000}}, \
    {0x1064193A,0x0100F8E8, {0xB8100000,0x00000000, 0x80800000,0x82028000}}, \
    /* ps_msub result is tiny before rounding. */                            \
    {0x106318F8,0x0100FCE0, {0xB8100000,0x00000000, 0x80800000,0x82028000}}, \
    {0x10641938,0x01010210, {0xB8100000,0x00000000, 0x80800000,0x82028000}}, \
    /* ps_nmadd result is tiny before rounding. */                           \
    {0x106320FE,0x010103AC, {0x38100000,0x00000000, 0x00800000,0x82024000}}, \
    {0x1064193E,0x0101092C, {0x38100000,0x00000000, 0x00800000,0x82024000}}, \
    /* ps_nmsub result is tiny before rounding. */                           \
    {0x106318FC,0x01010AC0, {0x38100000,0x00000000, 0x00800000,0x82024000}}, \
    {0x1064193C,0x01010FF4, {0x38100000,0x00000000, 0x00800000,0x82024000}}

/* Expected errors for the NATIVE_RECIPROCAL optimization (assuming the
 * no-reciprocal-tables version of the test code). */
#define EXPECTED_ERRORS_NATIVE_RECIPROCAL  \
    /* fres expecting HUGE_VALF instead of infinity. */                      \
    {0xEC606830,0x01009920, {0x7FF00000,0x00000000, 0x90025000,0x00000000}}, \
    {0xEC806830,0x0100993C, {0xFFF00000,0x00000000, 0x90029000,0x00000000}}, \
    /* ps_res expecting HUGE_VALF instead of infinity. */                    \
    {0x10606830,0x01010AE8, {0x7FF00000,0x00000000, 0x7F800000,0x92025000}}, \
    {0x10806830,0x01010B08, {0xFFF00000,0x00000000, 0xFF800000,0x92029000}}, \
    {0x11C01830,0x01010CCC, {0xFFFC0000,0x00000000, 0x7F800000,0xB1031000}}, \
    {0x11C02830,0x01010D44, {0x3FF00000,0x00000000, 0x3F800000,0xF1025000}}, \
    /* ps_rsqrte expecting exact table result. */                            \
    {0x11C01834,0x01010FC8, {0xFFFC0000,0x00000000, 0x3F3504F3,0xA1011000}}, \
    /* lfd/ps_rsqrte misbehavior. */                                         \
    {0x11A01834,0x010110A8, {0x00000000,0x00000000, 0x1F800001,0x82022000}}, \
    {0x11A02034,0x01011140, {0x7FF00000,0x00000000, 0x3F800000,0x84005000}}

/* Expected errors for the NO_FPSCR_STATE optimization. */
#define EXPECTED_ERRORS_NO_FPSCR_STATE  \
    /* frsp not aborted by enabled exception. */                             \
    {0xFC805818,0x01006D30, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    {0xFC601819,0x01006DEC, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    /* fadd not aborted by enabled exception. */                             \
    {0xFC6B082A,0x01006ECC, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    {0xFC6D482A,0x01006EF8, {0xFFF80000,0x00000000, 0xE0800000,0x00000000}}, \
    {0xFC61182B,0x01006FB0, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    /* fsub not aborted by enabled exception. */                             \
    {0xFC6B0828,0x01007168, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    {0xFC6D6828,0x01007194, {0xFFF80000,0x00000000, 0xE0800000,0x00000000}}, \
    {0xFC611829,0x0100724C, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    /* fmul not aborted by enabled exception. */                             \
    {0xFC6B0072,0x01007474, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    {0xFC600272,0x0100749C, {0xFFF80000,0x00000000, 0xE0100000,0x00000000}}, \
    {0xFC6100F3,0x01007594, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    /* fdiv not aborted by enabled exception. */                             \
    {0xFC6B0824,0x01007AF0, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    {0xFC696824,0x01007B1C, {0xFFF80000,0x00000000, 0xE0400000,0x00000000}}, \
    {0xFC642024,0x01007B48, {0xFFF80000,0x00000000, 0xE0200000,0x00000000}}, \
    {0xFC610024,0x01007B70, {0x7FF00000,0x00000000, 0xC4000000,0x00000000}}, \
    {0xFC611825,0x01007C28, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    /* fmadd not aborted by enabled exception. */                            \
    {0xFC6B107A,0x01008064, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    {0xFC600A7A,0x0100808C, {0xFFF80000,0x00000000, 0xE0100000,0x00000000}}, \
    {0xFC6968BA,0x010080B8, {0xFFF80000,0x00000000, 0xE0800000,0x00000000}}, \
    {0xFC6110FB,0x010081D8, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    /* fmsub not aborted by enabled exception. */                            \
    {0xFC6B1078,0x01008660, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    {0xFC600A78,0x01008688, {0xFFF80000,0x00000000, 0xE0100000,0x00000000}}, \
    {0xFC6948B8,0x010086B0, {0xFFF80000,0x00000000, 0xE0800000,0x00000000}}, \
    {0xFC6110F9,0x01008758, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    /* fnmadd not aborted by enabled exception. */                           \
    {0xFC6B107E,0x01008BCC, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    {0xFC600A7E,0x01008BF4, {0xFFF80000,0x00000000, 0xE0100000,0x00000000}}, \
    {0xFC6968BE,0x01008C20, {0xFFF80000,0x00000000, 0xE0800000,0x00000000}}, \
    {0xFC6110FF,0x01008CC8, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    /* fnmsub not aborted by enabled exception. */                           \
    {0xFC6B107C,0x01009158, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    {0xFC600A7C,0x01009180, {0xFFF80000,0x00000000, 0xE0100000,0x00000000}}, \
    {0xFC6948BC,0x010091A8, {0xFFF80000,0x00000000, 0xE0800000,0x00000000}}, \
    {0xFC6110FD,0x01009250, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    /* fctiw not aborted by enabled exception. */                            \
    {0xFC80D01C,0x010096A8, {0x3FF00000,0x00000000, 0xE0000100,0x00000000}}, \
    {0xFC80E01C,0x010096BC, {0x3FF00000,0x00000000, 0xE0000100,0x00000000}}, \
    {0xFC80501C,0x010096D0, {0x3FF00000,0x00000000, 0xE0000100,0x00000000}}, \
    {0xFC80581C,0x010096E4, {0x3FF00000,0x00000000, 0xE1000100,0x00000000}}, \
    {0xFC60181D,0x010097B4, {0x00000000,0x80000000, 0xE1000100,0x00000000}}, \
    /* fres not aborted by enabled exception. */                             \
    {0xEC602830,0x01009A24, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    {0xEC602030,0x01009A50, {0x7FF00000,0x00000000, 0xC4000000,0x00000000}}, \
    {0xEC601831,0x01009B10, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    /* frsqrte not aborted by enabled exception. */                          \
    {0xFC602834,0x01009F68, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    {0xFC60D834,0x01009F90, {0x7FF80000,0x00000000, 0xE0000200,0x00000000}}, \
    {0xFC602034,0x01009FBC, {0xFFF00000,0x00000000, 0xC4000000,0x00000000}}, \
    {0xFC601835,0x0100A07C, {0xFFFC0000,0x00000000, 0xE1000000,0x00000000}}, \
    /* ps_add not aborted by enabled exception. */                           \
    {0x106B082A,0x0100D610, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    {0x106D482A,0x0100D640, {0xFFF80000,0x00000000, 0xFFC00000,0xE0800000}}, \
    {0x1065682A,0x0100D6E0, {0xFFFC0000,0x00000000, 0x7F800000,0xF3020000}}, \
    {0x106D282A,0x0100D71C, {0x7FF00000,0x00000000, 0xFFE00000,0xF3025000}}, \
    {0x1061182B,0x0100D8BC, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    /* ps_sum0 not aborted by enabled exception. */                          \
    {0x106B0854,0x0100D9B0, {0xFFFC0000,0x00000000, 0x3F800000,0xE1000000}}, \
    {0x106D4814,0x0100D9E0, {0xFFF80000,0x00000000, 0x00000000,0xE0800000}}, \
    {0x10611895,0x0100DBC8, {0xFFFC0000,0x00000000, 0x40000000,0xE1000000}}, \
    /* ps_sum1 not aborted by enabled exception. */                          \
    {0x106B0856,0x0100DCBC, {0x3FF00000,0x00000000, 0xFFE00000,0xE1000000}}, \
    {0x106D4816,0x0100DCEC, {0x00000000,0x00000000, 0xFFC00000,0xE0800000}}, \
    {0x10611897,0x0100DEDC, {0x40000000,0x00000000, 0xFFE00000,0xE1000000}}, \
    /* ps_sub not aborted by enabled exception. */                           \
    {0x106B0828,0x0100DFD4, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    {0x106D6828,0x0100E004, {0xFFF80000,0x00000000, 0xFFC00000,0xE0800000}}, \
    {0x10656828,0x0100E0B0, {0xFFFC0000,0x00000000, 0xFF800000,0xF3020000}}, \
    {0x106D2828,0x0100E0F0, {0xFFF00000,0x00000000, 0xFFE00000,0xF3029000}}, \
    {0x10611829,0x0100E29C, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    /* ps_mul not aborted by enabled exception. */                           \
    {0x106B0072,0x0100E404, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    {0x10600272,0x0100E430, {0xFFF80000,0x00000000, 0xFFC00000,0xE0100000}}, \
    {0x10650372,0x0100E4D0, {0xFFFC0000,0x00000000, 0x7F800000,0xF3020000}}, \
    {0x106D0172,0x0100E50C, {0x7FF00000,0x00000000, 0xFFE00000,0xF3025000}}, \
    {0x106100F3,0x0100EB3C, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    /* ps_muls0 not aborted by enabled exception. */                         \
    {0x10650358,0x0100EBDC, {0x7FF00000,0x00000000, 0xFFE00000,0xF3025000}}, \
    {0x10650359,0x0100EC64, {0x7FF00000,0x00000000, 0xFFE00000,0xF3025000}}, \
    /* ps_muls1 not aborted by enabled exception. */                         \
    {0x1065035A,0x0100ED0C, {0x7FF00000,0x00000000, 0xFFE00000,0xF3025000}}, \
    {0x1065035B,0x0100ED94, {0x7FF00000,0x00000000, 0xFFE00000,0xF3025000}}, \
    /* ps_div not aborted by enabled exception. */                           \
    {0x106B0824,0x0100EEC4, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    {0x10696824,0x0100EEF4, {0xFFF80000,0x00000000, 0xFFC00000,0xE0400000}}, \
    {0x10642024,0x0100EF24, {0xFFF80000,0x00000000, 0xFFC00000,0xE0200000}}, \
    {0x10610024,0x0100EF4C, {0x7FF00000,0x00000000, 0x7F800000,0xC4000000}}, \
    {0x10656824,0x0100EFEC, {0xFFFC0000,0x00000000, 0x7F800000,0xF3020000}}, \
    {0x106D2824,0x0100F028, {0x7FF00000,0x00000000, 0xFFE00000,0xF3025000}}, \
    {0x10652824,0x0100F080, {0xFFF80000,0x00000000, 0xFFC00000,0xE0600000}}, \
    {0x10612024,0x0100F0B4, {0x3FE00000,0x00000000, 0x7F800000,0xC4004000}}, \
    {0x10657024,0x0100F0E8, {0x7FF00000,0x00000000, 0x7F800000,0xD6020000}}, \
    {0x10611825,0x0100F234, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    /* ps_madd not aborted by enabled exception. */                          \
    {0x106B107A,0x0100F44C, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    {0x10600A7A,0x0100F478, {0xFFF80000,0x00000000, 0xFFC00000,0xE0100000}}, \
    {0x106968BA,0x0100F4A8, {0xFFF80000,0x00000000, 0xFFC00000,0xE0800000}}, \
    {0x1065237A,0x0100F5A4, {0xFFFC0000,0x00000000, 0x7F800000,0xF3020000}}, \
    {0x106D217A,0x0100F5E4, {0x7FF00000,0x00000000, 0xFFE00000,0xF3025000}}, \
    {0x106110FB,0x0100F9C0, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    /* ps_madds0 not aborted by enabled exception. */                        \
    {0x10650B5C,0x0100FA60, {0x7FF00000,0x00000000, 0xFFE00000,0xF3025000}}, \
    {0x10650B5D,0x0100FAE8, {0x7FF00000,0x00000000, 0xFFE00000,0xF3025000}}, \
    /* ps_madds1 not aborted by enabled exception. */                        \
    {0x10650B5E,0x0100FB90, {0x7FF00000,0x00000000, 0xFFE00000,0xF3025000}}, \
    {0x10650B5F,0x0100FC18, {0x7FF00000,0x00000000, 0xFFE00000,0xF3025000}}, \
    /* ps_msub not aborted by enabled exception. */                          \
    {0x106B1078,0x0100FE30, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    {0x10600A78,0x0100FE5C, {0xFFF80000,0x00000000, 0xFFC00000,0xE0100000}}, \
    {0x106948B8,0x0100FE88, {0xFFF80000,0x00000000, 0xFFC00000,0xE0800000}}, \
    {0x10652378,0x0100FF30, {0xFFFC0000,0x00000000, 0x7F800000,0xF3020000}}, \
    {0x106D2178,0x0100FF70, {0x7FF00000,0x00000000, 0xFFE00000,0xF3025000}}, \
    {0x106110F9,0x010102E8, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    /* ps_nmadd not aborted by enabled exception. */                         \
    {0x106B107E,0x010104FC, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    {0x10600A7E,0x01010528, {0xFFF80000,0x00000000, 0xFFC00000,0xE0100000}}, \
    {0x106968BE,0x01010558, {0xFFF80000,0x00000000, 0xFFC00000,0xE0800000}}, \
    {0x1065237E,0x01010600, {0xFFFC0000,0x00000000, 0xFF800000,0xF3020000}}, \
    {0x106D217E,0x01010640, {0xFFF00000,0x00000000, 0xFFE00000,0xF3029000}}, \
    {0x106110FF,0x01010A00, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    /* ps_nmsub not aborted by enabled exception. */                         \
    {0x106B107C,0x01010C0C, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    {0x10600A7C,0x01010C38, {0xFFF80000,0x00000000, 0xFFC00000,0xE0100000}}, \
    {0x106948BC,0x01010C64, {0xFFF80000,0x00000000, 0xFFC00000,0xE0800000}}, \
    {0x1065237C,0x01010D0C, {0xFFFC0000,0x00000000, 0xFF800000,0xF3020000}}, \
    {0x106D217C,0x01010D4C, {0xFFF00000,0x00000000, 0xFFE00000,0xF3029000}}, \
    {0x106110FD,0x010110C8, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    /* ps_res not aborted by enabled exception. */                           \
    {0x10602830,0x010112E4, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    {0x10602030,0x01011314, {0x7FF00000,0x00000000, 0x7F800000,0xC4000000}}, \
    {0x11C02030,0x010113C4, {0xFFFC0000,0x00000000, 0x7F7FFFFF,0xF1020000}}, \
    {0x11C02830,0x01011404, {0x47EFFFFF,0xE0000000, 0xFFE00000,0xF1024000}}, \
    {0x11C06830,0x01011440, {0x3FDFFF00,0x00000000, 0x7F800000,0xC4004000}}, \
    {0x10601831,0x010114B4, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    /* ps_rsqrte not aborted by enabled exception. */                        \
    {0x10602834,0x010119D4, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}, \
    {0x1060D834,0x01011A00, {0x7FF80000,0x00000000, 0x7FC00000,0xE0000200}}, \
    {0x10602034,0x01011A2C, {0xFFF00000,0x00000000, 0xFF800000,0xC4000000}}, \
    {0x11C02034,0x01011AD8, {0xFFFC0000,0x00000000, 0x3F34FD00,0xE1000000}}, \
    {0x11C02834,0x01011B0C, {0x3FE69FA0,0x00000000, 0xFFE00000,0xE1004000}}, \
    {0x11C06834,0x01011B40, {0x3FE69FA0,0x00000000, 0x7F800000,0xC4004000}}, \
    /* lfd/ps_rsqrte misbehavior. */                                         \
    {0x11A01834,0x01011B80, {0x00000000,0x00000000, 0x1F800041,0x00000000}}, \
    {0x11A02034,0x01011C18, {0x7FF00000,0x00000000, 0x00000000,0x00000000}}, \
    /* ps_rsqrte not aborted by enabled exception, continued. */             \
    {0x10601835,0x01011CEC, {0xFFFC0000,0x00000000, 0xFFE00000,0xE1000000}}

/* Expected errors for the PS_STORE_DENORMALS optimization. */
#define EXPECTED_ERRORS_PS_STORE_DENORMALS  \
    /* psq_st of denormal values, not zeroed due to the optimization. */     \
    {0xF0640000,0x0100B220, {0x00000003,0x00000004, 0x00000000,0x00000000}}

/*************************************************************************/
/************************** Callback functions ***************************/
/*************************************************************************/

/* Handler for system call exceptions. */
static void sc_handler(PPCState *state)
{
    ASSERT(state);
    state->gpr[3] = 1;
}

/*-----------------------------------------------------------------------*/

/* Handler for timebase register reads.  Returns a value which increments
 * on each TBL or TBU read. */
static uint64_t timebase_handler(PPCState *state)
{
    ASSERT(state);
    return state->tb++;
}

/*-----------------------------------------------------------------------*/

/* Handler for trap exceptions. */
static void trap_handler(PPCState *state)
{
    ASSERT(state);
    state->gpr[3] = 0;
    state->nia += 4;  // Continue with the next instruction.
}

/*************************************************************************/
/************************* Test helper functions *************************/
/*************************************************************************/

/**
 * setup_750cl:  Set up a guest memory region and processor state block
 * for running the PowerPC 750CL test routine.
 *
 * [Parameters]
 *     state: Processor state block to initialize.
 * [Return value]
 *     Newly allocated guest memory region (free with free() when no
 *     longer needed).
 */
static void *setup_750cl(PPCState *state)
{
    uint8_t *memory;
    memory = malloc(PPC750CL_MEMORY_SIZE);
    if (!memory) {
        return NULL;
    }
    memset(memory, 0, PPC750CL_MEMORY_SIZE);
    memcpy(memory + PPC750CL_START_ADDRESS, ppc750cl_bin,
           sizeof(ppc750cl_bin));

    memset(state, 0, sizeof(*state));
    state->timebase_handler = timebase_handler;
    state->sc_handler = sc_handler;
    state->trap_handler = trap_handler;
    state->fres_lut = ppc_fres_lut;
    state->frsqrte_lut = ppc_frsqrte_lut;
    state->gpr[4] = PPC750CL_SCRATCH_ADDRESS;
    state->gpr[5] = PPC750CL_ERROR_LOG_ADDRESS;
    state->fpr[1][0] = 1.0;

    return memory;
}

/*-----------------------------------------------------------------------*/

/**
 * check_750cl_errors:  Check the errors reported from the 750CL test
 * routine against the expected error list, and print any discrepancies
 * to stdout.
 *
 * [Parameters]
 *     count: Return value from the test routine.
 *     memory: Pointer to guest memory region.
 *     expected_errors: Array of expected errors.  Errors are matched by
 *         the first two words of the record; if the same test is listed
 *         multiple times, the first occurrence is used.
 *     expected_length: Length of the expected_errors array.
 * [Return value]
 *     True if only the expected errors were detected, false otherwise.
 */
static bool check_750cl_errors(
    int count, void *memory, const FailureRecord *expected_errors,
    int expected_length)
{
    if (count < 0) {
        printf("Test failed to bootstrap (error %d)\n", count);
        return false;
    }

    bool success = true;
    const uint32_t *error_log =
        (const uint32_t *)((uintptr_t)memory + PPC750CL_ERROR_LOG_ADDRESS);
    uint8_t *error_seen = malloc(expected_length);
    ASSERT(error_seen || !expected_length);
    memset(error_seen, 0, expected_length);
    bool printed_header = false;

    for (int i = 0; i < count; i++, error_log += 8) {
        const uint32_t insn = bswap_be32(error_log[0]);
        const uint32_t address = bswap_be32(error_log[1]);
        bool pass = false;

        int found_index = -1;
        for (int j = 0; j < expected_length; j++) {
            if (expected_errors[j].insn == insn
             && expected_errors[j].address == address) {
                error_seen[j] = 1;
                if (found_index < 0) {
                    found_index = j;
                    pass = true;
                    for (int k = 0; k < 6; k++) {
                        const uint32_t data = bswap_be32(error_log[2+k]);
                        if (data != expected_errors[j].data[k]) {
                            pass = false;
                            break;
                        }
                    }
                }
            }
        }

        if (!pass) {
            success = false;
            if (!printed_header) {
                printf("Unexpected errors detected:\n");
                printed_header = true;
            }
            printf("    %08X %08X  %08X %08X  %08X %08X", insn, address,
                   bswap_be32(error_log[2]), bswap_be32(error_log[3]),
                   bswap_be32(error_log[4]), bswap_be32(error_log[5]));
            if ((insn & 0xFC00003E) == 0xFC000034) {  // frsqrte
                printf("  %08X %08X",
                       bswap_be32(error_log[6]), bswap_be32(error_log[7]));
            }
            printf("\n");
            if (found_index >= 0) {
                printf("        `--> Expected: %08X %08X  %08X %08X",
                       expected_errors[found_index].data[0],
                       expected_errors[found_index].data[1],
                       expected_errors[found_index].data[2],
                       expected_errors[found_index].data[3]);
                if ((insn & 0xFC00003E) == 0xFC000034) {  // frsqrte
                    printf("  %08X %08X",
                           expected_errors[found_index].data[4],
                           expected_errors[found_index].data[5]);
                }
                printf("\n");
            }
        }
    }

    printed_header = false;
    for (int i = 0; i < expected_length; i++) {
        if (!error_seen[i]) {
            success = false;
            if (!printed_header) {
                printf("Expected errors not detected:\n");
                printed_header = true;
            }
            printf("    %08X %08X  %08X %08X  %08X %08X",
                   expected_errors[i].insn, expected_errors[i].address,
                   expected_errors[i].data[0], expected_errors[i].data[1],
                   expected_errors[i].data[2], expected_errors[i].data[3]);
            if ((expected_errors[i].insn & 0xFC00003E) == 0xFC000034) {
                printf("  %08X %08X",
                       expected_errors[i].data[4], expected_errors[i].data[5]);
            }
            printf("\n");
            for (int j = i+1; j < expected_length; j++) {
                if (expected_errors[j].insn == expected_errors[i].insn
                 && expected_errors[j].address == expected_errors[i].address) {
                    error_seen[j] = 1;
                }
            }
        }
    }

    free(error_seen);
    return success;
}

/*************************************************************************/
/*************************************************************************/
